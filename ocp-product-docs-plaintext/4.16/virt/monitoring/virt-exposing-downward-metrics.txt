Exposing downward metrics for virtual machines

As an administrator, you can expose a limited set of host and virtual machine (VM) metrics to a guest VM by first enabling a downwardMetrics feature gate and then configuring a downwardMetrics device.

Users can view the metrics results by using the command line or the vm-dump-metrics tool.
Enabling or disabling the downwardMetrics feature gate
You can enable or disable the downwardMetrics feature gate by performing either of the following actions:

Editing the HyperConverged custom resource (CR) in your default editor

Using the command line


Enabling or disabling the downward metrics feature gate in a YAML file
To expose downward metrics for a host virtual machine, you can enable the downwardMetrics feature gate by editing a YAML file.

You must have administrator privileges to enable the feature gate.


Open the HyperConverged custom resource (CR) in your default editor by running the following command:

Choose to enable or disable the downwardMetrics feature gate as follows:
Enabling or disabling the downward metrics feature gate from the command line
To expose downward metrics for a host virtual machine, you can enable the downwardMetrics feature gate by using the command line.

You must have administrator privileges to enable the feature gate.


Choose to enable or disable the downwardMetrics feature gate as follows:
Configuring a downward metrics device
You enable the capturing of downward metrics for a host VM by creating a configuration file that includes a downwardMetrics device. Adding this device establishes that the metrics are exposed through a virtio-serial port.

You must first enable the downwardMetrics feature gate.


Edit or create a YAML file that includes a downwardMetrics device, as shown in the following example:
Viewing downward metrics
You can view downward metrics by using either of the following options:

The command line interface (CLI)

The vm-dump-metrics tool


Viewing downward metrics by using the command line
You can view downward metrics by entering a command from inside a guest virtual machine (VM).

Run the following commands:
Viewing downward metrics by using the vm-dump-metrics tool
To view downward metrics, install the vm-dump-metrics tool and then use the tool to expose the metrics results.

Install the vm-dump-metrics tool by running the following command:

Retrieve the metrics results by running the following command: